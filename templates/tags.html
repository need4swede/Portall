{% extends "base.html" %}
{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="fas fa-tags"></i> Tag Management</h1>
        <div>
            <button id="create-tag-btn" class="btn btn-primary me-2">
                <i class="fas fa-plus"></i> Create Tag
            </button>
            <button id="create-rule-btn" class="btn btn-success">
                <i class="fas fa-magic"></i> Create Rule
            </button>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs mb-4" id="tagTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="tags-tab" data-bs-toggle="tab" data-bs-target="#tags-panel"
                type="button" role="tab">
                <i class="fas fa-tag"></i> Tags
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="rules-tab" data-bs-toggle="tab" data-bs-target="#rules-panel" type="button"
                role="tab">
                <i class="fas fa-cogs"></i> Tagging Rules
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="templates-tab" data-bs-toggle="tab" data-bs-target="#templates-panel"
                type="button" role="tab">
                <i class="fas fa-layer-group"></i> Templates
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="filter-tab" data-bs-toggle="tab" data-bs-target="#filter-panel" type="button"
                role="tab">
                <i class="fas fa-filter"></i> Filter Ports
            </button>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="tagTabContent">
        <!-- Tags Panel -->
        <div class="tab-pane fade show active" id="tags-panel" role="tabpanel">
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">All Tags</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <input type="text" id="tag-search" class="form-control" placeholder="Search tags...">
                            </div>
                            <div id="tags-list">
                                <!-- Tags will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Tag Statistics</h5>
                        </div>
                        <div class="card-body">
                            <div id="tag-stats">
                                <!-- Statistics will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rules Panel -->
        <div class="tab-pane fade" id="rules-panel" role="tabpanel">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">Tagging Rules</h5>
                    <button id="execute-all-rules-btn" class="btn btn-warning btn-sm">
                        <i class="fas fa-play"></i> Execute All Rules
                    </button>
                </div>
                <div class="card-body">
                    <div id="rules-list">
                        <!-- Rules will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Templates Panel -->
        <div class="tab-pane fade" id="templates-panel" role="tabpanel">
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">Rule Templates</h5>
                            <div class="d-flex gap-2">
                                <select id="template-category-filter" class="form-select form-select-sm"
                                    style="width: auto;">
                                    <option value="">All Categories</option>
                                </select>
                                <button id="import-template-btn" class="btn btn-outline-primary btn-sm">
                                    <i class="fas fa-upload"></i> Import
                                </button>
                                <button id="export-config-btn" class="btn btn-outline-success btn-sm">
                                    <i class="fas fa-download"></i> Export Config
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="templates-list">
                                <!-- Templates will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Quick Actions</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-grid gap-2">
                                <button id="apply-security-template" class="btn btn-outline-danger">
                                    <i class="fas fa-shield-alt"></i> Apply Security Hardening
                                </button>
                                <button id="apply-infrastructure-template" class="btn btn-outline-primary">
                                    <i class="fas fa-server"></i> Apply Infrastructure Mapping
                                </button>
                                <button id="apply-network-template" class="btn btn-outline-info">
                                    <i class="fas fa-network-wired"></i> Apply Network Segmentation
                                </button>
                                <button id="apply-monitoring-template" class="btn btn-outline-success">
                                    <i class="fas fa-chart-line"></i> Apply Monitoring Setup
                                </button>
                            </div>
                            <hr>
                            <div class="mb-3">
                                <label class="form-label">Configuration Management</label>
                                <div class="d-grid gap-2">
                                    <button id="import-config-btn" class="btn btn-outline-secondary btn-sm">
                                        <i class="fas fa-file-import"></i> Import Configuration
                                    </button>
                                    <button id="backup-config-btn" class="btn btn-outline-warning btn-sm">
                                        <i class="fas fa-save"></i> Backup Current Setup
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-3">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Template Statistics</h5>
                        </div>
                        <div class="card-body">
                            <div id="template-stats">
                                <!-- Statistics will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Panel -->
        <div class="tab-pane fade" id="filter-panel" role="tabpanel">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Filter Ports by Tags</h5>
                </div>
                <div class="card-body">
                    <form id="filter-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Tags</label>
                                    <select id="filter-tags" class="form-select" multiple>
                                        <!-- Options will be loaded -->
                                    </select>
                                    <div class="form-text">Hold Ctrl/Cmd to select multiple tags</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Tag Logic</label>
                                    <select id="filter-tag-operator" class="form-select">
                                        <option value="AND">Must have ALL selected tags</option>
                                        <option value="OR">Must have ANY selected tag</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">IP Address</label>
                                    <input type="text" id="filter-ip" class="form-control"
                                        placeholder="e.g., 192.168.1">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Port Number</label>
                                    <input type="number" id="filter-port" class="form-control" placeholder="e.g., 8080">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Description</label>
                                    <input type="text" id="filter-description" class="form-control"
                                        placeholder="e.g., web">
                                </div>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-search"></i> Filter Ports
                            </button>
                            <button type="button" id="clear-filter-btn" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                    </form>

                    <div id="filter-results" class="mt-4" style="display: none;">
                        <h6>Filter Results</h6>
                        <div id="filtered-ports">
                            <!-- Filtered ports will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Create/Edit Tag Modal -->
<div class="modal fade" id="tagModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="tagModalTitle">Create Tag</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="tag-form">
                    <input type="hidden" id="tag-id">
                    <div class="mb-3">
                        <label for="tag-name" class="form-label">Tag Name *</label>
                        <input type="text" class="form-control" id="tag-name" required>
                    </div>
                    <div class="mb-3">
                        <label for="tag-color" class="form-label">Color</label>
                        <input type="color" class="form-control form-control-color" id="tag-color" value="#007bff">
                    </div>
                    <div class="mb-3">
                        <label for="tag-description" class="form-label">Description</label>
                        <textarea class="form-control" id="tag-description" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-tag-btn">Save Tag</button>
            </div>
        </div>
    </div>
</div>

<!-- Create/Edit Rule Modal -->
<div class="modal fade" id="ruleModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ruleModalTitle">Create Tagging Rule</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="rule-form">
                    <input type="hidden" id="rule-id">

                    <!-- Basic Info -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <label for="rule-name" class="form-label">Rule Name *</label>
                            <input type="text" class="form-control" id="rule-name" required
                                placeholder="e.g., Tag web services">
                        </div>
                        <div class="col-md-4">
                            <div class="form-check form-switch mt-4">
                                <input class="form-check-input" type="checkbox" id="rule-enabled" checked>
                                <label class="form-check-label" for="rule-enabled">
                                    <strong>Enable this rule</strong>
                                </label>
                            </div>
                            <div class="form-check form-switch mt-2">
                                <input class="form-check-input" type="checkbox" id="rule-auto-execute">
                                <label class="form-check-label" for="rule-auto-execute">
                                    <strong>Auto-execute</strong>
                                </label>
                                <div class="form-text">Automatically apply this rule when ports are created or modified
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="rule-description" class="form-label">Description (Optional)</label>
                        <textarea class="form-control" id="rule-description" rows="2"
                            placeholder="Describe what this rule does..."></textarea>
                    </div>

                    <!-- Rule Builder -->
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h6 class="mb-0"><i class="fas fa-filter"></i> When ports match these conditions:</h6>
                            <div class="form-group mb-0">
                                <select class="form-select form-select-sm" id="condition-operator" style="width: auto;">
                                    <option value="AND">Match ALL conditions</option>
                                    <option value="OR">Match ANY condition</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="rule-conditions">
                                <!-- Conditions will be built here -->
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm" id="add-condition-btn">
                                <i class="fas fa-plus"></i> Add Another Condition
                            </button>
                            <small class="text-muted d-block mt-2" id="condition-logic-help">
                                All conditions must be met (AND logic)
                            </small>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h6 class="mb-0"><i class="fas fa-magic"></i> Then apply these tags:</h6>
                        </div>
                        <div class="card-body">
                            <div id="rule-actions">
                                <!-- Actions will be built here -->
                            </div>
                            <button type="button" class="btn btn-outline-success btn-sm" id="add-action-btn">
                                <i class="fas fa-plus"></i> Add Another Action
                            </button>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="card">
                        <div class="card-header">
                            <button class="btn btn-link p-0 text-decoration-none" type="button"
                                data-bs-toggle="collapse" data-bs-target="#advanced-settings">
                                <i class="fas fa-cog"></i> Advanced Settings
                                <i class="fas fa-chevron-down ms-1"></i>
                            </button>
                        </div>
                        <div class="collapse" id="advanced-settings">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="rule-priority" class="form-label">Priority</label>
                                        <input type="number" class="form-control" id="rule-priority" value="0">
                                        <small class="form-text text-muted">Higher numbers run first</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="save-rule-btn">
                    <i class="fas fa-save"></i> Save Rule
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Bulk Tag Modal -->
<div class="modal fade" id="bulkTagModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Bulk Tag Operations</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="bulk-tag-form">
                    <div class="mb-3">
                        <label class="form-label">Selected Ports</label>
                        <div id="selected-ports-list" class="p-2">
                            <!-- Selected ports will be shown here -->
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Tags</label>
                        <select id="bulk-tags" class="form-select" multiple required>
                            <!-- Tag options will be loaded -->
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Action</label>
                        <select id="bulk-action" class="form-select">
                            <option value="add">Add tags to ports</option>
                            <option value="remove">Remove tags from ports</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="execute-bulk-btn">Execute</button>
            </div>
        </div>
    </div>
</div>

<!-- Notification Area -->
<div id="notification-area" class="position-fixed top-0 end-0 p-3" style="z-index: 1050;">
    <!-- Notifications will appear here -->
</div>

<style>
    /* Custom modal sizing for rule builder */
    #ruleModal .modal-dialog {
        max-width: 1000px;
        width: 95%;
        margin: 1rem auto;
    }

    /* Responsive modal sizing */
    @media (max-width: 576px) {
        #ruleModal .modal-dialog {
            max-width: 100%;
            width: 100%;
            margin: 0.5rem;
        }

        #ruleModal .modal-content {
            border-radius: 0.5rem;
        }

        /* Stack columns on mobile */
        #ruleModal .condition-item .row>div,
        #ruleModal .action-item .row>div {
            margin-bottom: 0.5rem;
        }
    }

    @media (min-width: 577px) and (max-width: 768px) {
        #ruleModal .modal-dialog {
            max-width: 90%;
            width: 90%;
        }
    }

    @media (min-width: 769px) and (max-width: 992px) {
        #ruleModal .modal-dialog {
            max-width: 900px;
            width: 85%;
        }
    }

    @media (min-width: 993px) {
        #ruleModal .modal-dialog {
            max-width: 1000px;
            width: 80%;
        }
    }

    /* Tag styling */
    .tag-badge {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        margin: 0.125rem;
        border-radius: 0.375rem;
        color: white;
        font-size: 0.875rem;
        text-decoration: none;
    }

    .tag-badge:hover {
        opacity: 0.8;
        color: white;
        text-decoration: none;
    }

    /* Light theme styles */
    .tag-item {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 1rem;
        margin-bottom: 0.5rem;
        background: white;
        transition: background-color 0.15s ease-in-out;
    }

    .tag-item:hover {
        background: #f8f9fa;
    }

    .rule-item {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 1rem;
        margin-bottom: 0.5rem;
        background: white;
        transition: background-color 0.15s ease-in-out;
    }

    .rule-item.disabled {
        opacity: 0.6;
        background: #f8f9fa;
    }

    .condition-item .card,
    .action-item .card {
        border: 1px solid var(--bs-border-color, #e9ecef);
        background: var(--bs-secondary-bg, #f8f9fa);
        transition: all 0.15s ease-in-out;
    }

    .port-item {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 0.75rem;
        margin-bottom: 0.5rem;
        background: white;
        transition: background-color 0.15s ease-in-out;
    }

    .port-tags {
        margin-top: 0.5rem;
    }

    .usage-badge {
        background-color: #6c757d;
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 0.375rem;
        font-size: 0.75rem;
    }

    /* Dark theme styles */
    [data-bs-theme="dark"] .tag-item {
        border: 1px solid #495057;
        background: #343a40;
        color: #f8f9fa;
    }

    [data-bs-theme="dark"] .tag-item:hover {
        background: #495057;
    }

    [data-bs-theme="dark"] .rule-item {
        border: 1px solid #495057;
        background: #343a40;
        color: #f8f9fa;
    }

    [data-bs-theme="dark"] .rule-item.disabled {
        background: #495057;
    }

    [data-bs-theme="dark"] .condition-item .card,
    [data-bs-theme="dark"] .action-item .card {
        border: 1px solid #495057 !important;
        background: #495057 !important;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .port-item {
        border: 1px solid #495057;
        background: #343a40;
        color: #f8f9fa;
    }

    /* Modal dark mode styling */
    [data-bs-theme="dark"] .modal-content {
        background-color: #212529 !important;
        color: #f8f9fa !important;
        border: 1px solid #495057;
    }

    [data-bs-theme="dark"] .modal-header {
        background-color: #212529 !important;
        border-bottom: 1px solid #495057;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .modal-body {
        background-color: #212529 !important;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .modal-footer {
        background-color: #212529 !important;
        border-top: 1px solid #495057;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .modal-title {
        color: #f8f9fa !important;
    }

    /* Card styling for dark mode */
    [data-bs-theme="dark"] .card {
        background-color: #343a40 !important;
        border: 1px solid #495057 !important;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .card-header {
        background-color: #495057 !important;
        border-bottom: 1px solid #6c757d !important;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .card-body {
        background-color: #343a40 !important;
        color: #f8f9fa !important;
    }

    /* Override Bootstrap's bg-light in dark mode */
    [data-bs-theme="dark"] .bg-light {
        background-color: #495057 !important;
        color: #f8f9fa !important;
    }

    /* Form controls in dark mode */
    [data-bs-theme="dark"] .form-control,
    [data-bs-theme="dark"] .form-select {
        background-color: #495057 !important;
        border-color: #6c757d !important;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .form-control:focus,
    [data-bs-theme="dark"] .form-select:focus {
        background-color: #495057 !important;
        border-color: #86b7fe !important;
        color: #f8f9fa !important;
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
    }

    [data-bs-theme="dark"] .form-control:disabled,
    [data-bs-theme="dark"] .form-select:disabled {
        background-color: #343a40 !important;
        border-color: #495057 !important;
        color: #6c757d !important;
    }

    [data-bs-theme="dark"] .form-control::placeholder {
        color: #adb5bd !important;
    }

    /* Form labels and text */
    [data-bs-theme="dark"] .form-label {
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .text-muted {
        color: #adb5bd !important;
    }

    [data-bs-theme="dark"] .small {
        color: #adb5bd !important;
    }

    /* Button styling for dark mode */
    [data-bs-theme="dark"] .btn-outline-primary {
        color: #86b7fe !important;
        border-color: #86b7fe !important;
    }

    [data-bs-theme="dark"] .btn-outline-primary:hover {
        background-color: #0d6efd !important;
        border-color: #0d6efd !important;
        color: #fff !important;
    }

    [data-bs-theme="dark"] .btn-outline-success {
        color: #75b798 !important;
        border-color: #75b798 !important;
    }

    [data-bs-theme="dark"] .btn-outline-success:hover {
        background-color: #198754 !important;
        border-color: #198754 !important;
        color: #fff !important;
    }

    [data-bs-theme="dark"] .btn-outline-danger {
        color: #ea868f !important;
        border-color: #ea868f !important;
    }

    [data-bs-theme="dark"] .btn-outline-danger:hover {
        background-color: #dc3545 !important;
        border-color: #dc3545 !important;
        color: #fff !important;
    }

    [data-bs-theme="dark"] .btn-link {
        color: #86b7fe !important;
    }

    [data-bs-theme="dark"] .btn-link:hover {
        color: #b6d7ff !important;
    }

    /* Badge adjustments for dark mode */
    [data-bs-theme="dark"] .badge.bg-secondary {
        background-color: #6c757d !important;
        color: #fff !important;
    }

    [data-bs-theme="dark"] .badge.bg-info {
        background-color: #0dcaf0 !important;
        color: #000 !important;
    }

    [data-bs-theme="dark"] .badge.bg-success {
        background-color: #198754 !important;
        color: #fff !important;
    }

    [data-bs-theme="dark"] .badge.bg-danger {
        background-color: #dc3545 !important;
        color: #fff !important;
    }

    /* Textarea styling */
    [data-bs-theme="dark"] textarea.form-control {
        background-color: #495057 !important;
        border-color: #6c757d !important;
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] textarea.form-control:focus {
        background-color: #495057 !important;
        border-color: #86b7fe !important;
        color: #f8f9fa !important;
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
    }

    /* Input group styling */
    [data-bs-theme="dark"] .input-group-text {
        background-color: #495057 !important;
        border-color: #6c757d !important;
        color: #f8f9fa !important;
    }

    /* Dropdown styling */
    [data-bs-theme="dark"] .dropdown-menu {
        background-color: #343a40 !important;
        border: 1px solid #495057 !important;
    }

    [data-bs-theme="dark"] .dropdown-item {
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .dropdown-item:hover {
        background-color: #495057 !important;
        color: #f8f9fa !important;
    }

    /* Close button for dark mode */
    [data-bs-theme="dark"] .btn-close {
        filter: invert(1) grayscale(100%) brightness(200%);
    }

    /* Form check styling */
    [data-bs-theme="dark"] .form-check-label {
        color: #f8f9fa !important;
    }

    [data-bs-theme="dark"] .form-check-input {
        background-color: #495057 !important;
        border-color: #6c757d !important;
    }

    [data-bs-theme="dark"] .form-check-input:checked {
        background-color: #0d6efd !important;
        border-color: #0d6efd !important;
    }

    /* Color input styling */
    [data-bs-theme="dark"] .form-control-color {
        background-color: #495057 !important;
        border-color: #6c757d !important;
    }

    /* Collapse button styling */
    [data-bs-theme="dark"] .collapse .card-body {
        background-color: #343a40 !important;
        color: #f8f9fa !important;
    }

    /* Responsive text sizing */
    @media (max-width: 576px) {
        .modal-title {
            font-size: 1.1rem;
        }

        .card-title,
        .form-label {
            font-size: 0.9rem;
        }

        .btn-sm {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
        }

        .tag-badge {
            font-size: 0.75rem;
            padding: 0.2rem 0.4rem;
        }
    }

    /* Improved spacing for mobile */
    @media (max-width: 768px) {
        #ruleModal .card-body {
            padding: 0.75rem;
        }

        #ruleModal .modal-body {
            padding: 1rem;
        }

        #ruleModal .row {
            margin: 0 -0.5rem;
        }

        #ruleModal .row>* {
            padding: 0 0.5rem;
        }
    }
</style>
{% endblock %}

{% block scripts %}
<script type="module" src="{{ url_for('static', filename='js/tags.js') }}"></script>
{% endblock %}